---
title: "FEDRES H.8"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    theme: 
      version: 3
      bootswatch: flatly
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
```

```{r}
library(flexdashboard)
library(rvest)
library(xml2)
library(ggplot2)
library(tidyverse)
library(writexl)
library(readxl)
library(readr)
library(kableExtra)
library(DT)
library(shiny)
library(lubridate)
library(extrafont)
```

```{r}
# copy and paste the link in the brackets and run the code
html <- read_html('https://www.federalreserve.gov/releases/h8/20230505/')

tables <- list()

# Loop over the sequence of numbers
for (i in 1:11) {
  
  id <- paste0("#h8t", i)
  
  # Scrape the table using table's id
  table <- html %>% 
    html_nodes(id) %>% 
    html_table(fill = TRUE)
  
  tables[[paste0("table_", i)]] <- table
}
```

```{r}
colnames <- c("Date", "Bank credit", 
  "Securities in bank credit", 
  "Treasury and agency securities",
  "Mortgage-backed securities (MBS)",
  "Non-MBS",
  "Other securities",
  "Mortgage-backed securities (MBS) other",
  "Non-MBS other",
  "Loans and leases in bank credit", 
  "Commercial and industrial loans", 
  "Real estate loans",                                 
  "Residential real estate loans",                      
  "Revolving home equity loans",                       
  "Closed-end residential loans",                    
  "Commercial real estate loans",
  "Construction and land development loans",
  "Secured by farmland",
  "Secured by multifamily properties",
  "Secured by nonfarm nonresidential properties",
  "Consumer loans",                                     
  "Credit cards and other revolving plans",             
  "Other consumer loans", 
  "Automobile loans",
  "All other consumer loans",
  "All other loans and leases",  
  "Loans to nondepository financial institutions",
  "All loans not elsewhere classified",
  "LESS: Allowance for loan and lease losses",          
  "Cash assets",                                    
  "Total federal funds sold and reverse RPs",       
  "Loans to commercial banks",                      
  "Other assets including trading assets",          
  "Total assets", 
  "Deposits",                                           
  "Large time deposits",                                
  "Other deposits",                                     
  "Borrowings",  
  "Net due to related foreign offices",
  "Other liabilities including trading liabilities",
  "Total liabilities",
  "Residual (Assets LESS Liabilities)") 

colnames <- gsub(" ", "_", colnames)

# important note! data is being published each friday. 
# the code assumes that 
today <- as.Date(format(Sys.Date(), "%Y-%m-%d"))

# loading historical data from https://www.federalreserve.gov/datadownload/Choose.aspx?rel=H8
# from the beginning to May 3rd
Commercial_Banks_SA_weekly <- read.csv("Commercial_Banks_SA_weekly.csv")
Commercial_Banks_NSA_weekly <- read.csv("Commercial_Banks_NSA_weekly.csv")
Domestic_SA_weekly <- read.csv("Domestic_SA_weekly.csv")
Domestic_NSA_weekly <- read.csv("Domestic_NSA_weekly.csv")
Large_Domestic_SA_weekly <- read.csv("Large_Domestic_SA_weekly.csv")
Large_Domestic_NSA_weekly <- read.csv("Large_Domestic_NSA_weekly.csv")
Small_Domestic_SA_weekly <- read.csv("Small_Domestic_SA_weekly.csv")
Small_Domestic_NSA_weekly <- read.csv("Small_Domestic_NSA_weekly.csv")
Foreign_SA_weekly <- read.csv("Foreign_SA_weekly.csv")
Foreign_NSA_weekly <- read.csv("Foreign_NSA_weekly.csv")

# naming columns
colnames(Commercial_Banks_SA_weekly) <- colnames
colnames(Commercial_Banks_NSA_weekly) <- colnames
colnames(Domestic_SA_weekly) <- colnames
colnames(Domestic_NSA_weekly) <- colnames
colnames(Large_Domestic_SA_weekly) <- colnames
colnames(Large_Domestic_NSA_weekly) <- colnames
colnames(Small_Domestic_SA_weekly) <- colnames
colnames(Small_Domestic_NSA_weekly) <- colnames
colnames(Foreign_SA_weekly) <- colnames
colnames(Foreign_NSA_weekly) <- colnames

# convert string to date format
Commercial_Banks_SA_weekly$Date <- as.Date(Commercial_Banks_SA_weekly$Date, format = "%m/%d/%Y")
Commercial_Banks_NSA_weekly$Date <- as.Date(Commercial_Banks_NSA_weekly$Date, format = "%m/%d/%Y")
Domestic_SA_weekly$Date <- as.Date(Domestic_SA_weekly$Date, format = "%m/%d/%Y")
Domestic_NSA_weekly$Date <- as.Date(Domestic_NSA_weekly$Date, format = "%m/%d/%Y")
Large_Domestic_SA_weekly$Date <- as.Date(Large_Domestic_SA_weekly$Date, format = "%m/%d/%Y")
Large_Domestic_NSA_weekly$Date <- as.Date(Large_Domestic_NSA_weekly$Date, format = "%m/%d/%Y")
Small_Domestic_SA_weekly$Date <- as.Date(Small_Domestic_SA_weekly$Date, format = "%m/%d/%Y")
Small_Domestic_NSA_weekly$Date <- as.Date(Small_Domestic_NSA_weekly$Date, format = "%m/%d/%Y")
Foreign_SA_weekly$Date <- as.Date(Foreign_SA_weekly$Date, format = "%m/%d/%Y")
Foreign_NSA_weekly$Date <- as.Date(Foreign_NSA_weekly$Date, format = "%m/%d/%Y")

# historical data is in millions $. converting to billions to match updated data 
Commercial_Banks_SA_weekly[,c(2:42)] <- Commercial_Banks_SA_weekly[,c(2:42)] / 1000 
Commercial_Banks_NSA_weekly[,c(2:42)] <- Commercial_Banks_NSA_weekly[,c(2:42)] / 1000 
Domestic_SA_weekly[,c(2:42)] <- Domestic_SA_weekly[,c(2:42)] / 1000 
Domestic_NSA_weekly[,c(2:42)] <- Domestic_NSA_weekly[,c(2:42)] / 1000 
Large_Domestic_SA_weekly[,c(2:42)] <- Large_Domestic_SA_weekly[,c(2:42)] / 1000 
Large_Domestic_NSA_weekly[,c(2:42)] <- Large_Domestic_NSA_weekly[,c(2:42)] / 1000 
Small_Domestic_SA_weekly[,c(2:42)] <- Small_Domestic_SA_weekly[,c(2:42)] / 1000 
Small_Domestic_NSA_weekly[,c(2:42)] <- Small_Domestic_NSA_weekly[,c(2:42)] / 1000 
Foreign_SA_weekly[,c(2:42)] <- Foreign_SA_weekly[,c(2:42)] / 1000 
Foreign_NSA_weekly[,c(2:42)] <- Foreign_NSA_weekly[,c(2:42)] / 1000 

# the following code extracts the this week's latest release, cleans it and makes prepares it to be added to the historic data
update_table <- function(table_index) {
  table_name <- paste0("table_", table_index)
  data <- data.frame(tables[[table_name]])
  latest <- matrix(data$Week.ending.3, nrow = 1) %>% .[, -c(1, 2, 36, 37)]
  latest <- matrix(as.numeric(gsub(",", "", latest)), nrow = 1)
  update <- data.frame(Date = today, latest)
  colnames(update) <- colnames
  return(update)
}

# Table 2. Assets and Liabilities of Commercial Banks in the United States
# Seasonally adjusted, billions of dollars.
update_2 <- update_table(2)

# Table 3. Assets and Liabilities of Commercial Banks in the United States
# Not seasonally adjusted, billions of dollars.
update_3 <- update_table(3)

# Table 4. Assets and Liabilities of Domestically Chartered Commercial Banks in the United States
# Seasonally adjusted, billions of dollars.
update_4 <- update_table(4)

# Table 5. Assets and Liabilities of Domestically Chartered Commercial Banks in the United States
# Not seasonally adjusted, billions of dollars.
update_5 <- update_table(5)

# Table 6. Assets and Liabilities of Large Domestically Chartered Commercial Banks in the United States
# Seasonally adjusted, billions of dollars.
update_6 <- update_table(6)

# Table 7. Assets and Liabilities of Large Domestically Chartered Commercial Banks in the United States
# Not seasonally adjusted, billions of dollars.
update_7 <- update_table(7)

# Table 8. Assets and Liabilities of Small Domestically Chartered Commercial Banks in the United States
# Seasonally adjusted, billions of dollars.
update_8 <- update_table(8)

# Table 9. Assets and Liabilities of Small Domestically Chartered Commercial Banks in the United States 
# Not seasonally adjusted, billions of dollars.
update_9 <- update_table(9)

# Table 10. Assets and Liabilities of Foreign-Related Institutions in the United States
# Seasonally adjusted, billions of dollars.
update_10 <- update_table(10)

# Table 11. Assets and Liabilities of Foreign-Related Institutions in the United States
# Not seasonally adjusted, billions of dollars.
update_11 <- update_table(11)

# updating the historic data with updated
Commercial_Banks_SA_weekly <- rbind(Commercial_Banks_SA_weekly, update_2)
Commercial_Banks_NSA_weekly <- rbind(Commercial_Banks_NSA_weekly, update_3)
Domestic_SA_weekly <- rbind(Domestic_SA_weekly, update_4)
Domestic_NSA_weekly <- rbind(Domestic_NSA_weekly, update_5)
Large_Domestic_SA_weekly <- rbind(Large_Domestic_SA_weekly, update_6)
Large_Domestic_NSA_weekly <- rbind(Large_Domestic_NSA_weekly, update_7)
Small_Domestic_SA_weekly <- rbind(Small_Domestic_SA_weekly, update_8)
Small_Domestic_NSA_weekly <- rbind(Small_Domestic_NSA_weekly, update_9)
Foreign_SA_weekly <- rbind(Foreign_SA_weekly, update_10)
Foreign_NSA_weekly <- rbind(Foreign_NSA_weekly, update_11)
```

# Info

## Executive Summary {.col width="10/20"}

TEXTTEXTTEXTTEXTTEX



## Description {.tabset .tabset-fade}

### About Data 

The H.8 release provides an estimated weekly aggregate balance sheet for all commercial banks in the United States. The release also includes separate balance sheet aggregations for several bank groups: **domestically chartered commercial banks**; **large domestically chartered commercial banks**; **small domestically chartered commercial banks**; and **foreign-related institutions** in the United States.

Published weekly, the release is typically available to the public by *4:15 p.m. each Friday*. If Friday is a federal holiday, then the data are released on Thursday. H.8 release is primarily based on data that are reported weekly by a sample of approximately 875 domestically chartered banks and foreign-related institutions.

 - **Large domestically chartered commercial banks (Large Domestic Banks)** are defined as the top 25 domestically chartered commercial banks ranked by size. 

 - **Small domestically chartered commercial banks (Small Domestic Banks)** are defined as all domestically chartered banks outside of the top 25.

 - **Foreign-related institutions** include U.S. branches and agencies of foreign banks as well as Edge Act and agreement corporations.

### Download Data

This section provides you with the latest data on Assets and Liabilities of Commercial Banks in the United States. The data is presented in several forms, reflecting different aggregations and adjustments for seasonality. Click the button below to download the data as an Excel file.

```{r}
ui <- fluidPage(
  downloadButton('downloadData', 'Download data', style = "color: #fff; background-color: #27ae60; border-color: #fff;padding: 15px 42px 15px 42px;margin: 15px 15px 15px 15px; ")
)

server <- function(input, output) {
  
  output$downloadData <- downloadHandler(
    filename = function() {
      paste('Assets and Liabilities of Commercial Banks in the United States ', Sys.Date(), '.xlsx', sep='')
    },
    content = function(file) {
      # Your data frames
      data_list <- list(
        Commercial_Banks_SA_weekly = Commercial_Banks_SA_weekly,
        Commercial_Banks_NSA_weekly = Commercial_Banks_NSA_weekly,
        Domestic_SA_weekly = Domestic_SA_weekly,
        Domestic_NSA_weekly = Domestic_NSA_weekly,
        Large_Domestic_SA_weekly = Large_Domestic_SA_weekly,
        Large_Domestic_NSA_weekly = Large_Domestic_NSA_weekly,
        Small_Domestic_SA_weekly = Small_Domestic_SA_weekly,
        Small_Domestic_NSA_weekly = Small_Domestic_NSA_weekly,
        Foreign_SA_weekly = Foreign_SA_weekly,
        Foreign_NSA_weekly = Foreign_NSA_weekly
      )

      # Write the list to an Excel file
      write_xlsx(data_list, path = file)
    }
  )
}

shinyApp(ui, server)
```

This can later be used to visualize the data in Excel or Tableau.

# Bank Credit {data-navmenu="Commercial Banks"}

## Stats {.sidebar}


### Stats:

```{r}
kable(t(summarise(Commercial_Banks_SA_weekly,
  'Last Value, bln $' = last(Commercial_Banks_SA_weekly$Bank_credit),
  'Change from Last Week' = paste0(format((last(Commercial_Banks_SA_weekly$Bank_credit) / nth(Commercial_Banks_SA_weekly$Bank_credit, n = -2) - 1), digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format(last(Commercial_Banks_SA_weekly$Bank_credit) / nth(Commercial_Banks_SA_weekly$Bank_credit, n = -5) - 1, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Commercial_Banks_SA_weekly$Bank_credit) / nth(Commercial_Banks_SA_weekly$Bank_credit, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F) %>% 
  kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Bank Credit {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_SA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_NSA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Bank Credit (difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted 

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Borrowings {data-navmenu="Commercial Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Commercial_Banks_SA_weekly,
  'Last Value, bln $' = last(Commercial_Banks_SA_weekly$Borrowings),
  'Change from Last Week' = paste0(format((last(Commercial_Banks_SA_weekly$Borrowings) / nth(Commercial_Banks_SA_weekly$Borrowings, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Commercial_Banks_SA_weekly$Borrowings) / nth(Commercial_Banks_SA_weekly$Borrowings, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Commercial_Banks_SA_weekly$Borrowings) / nth(Commercial_Banks_SA_weekly$Borrowings, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Borrowings {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_SA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_NSA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Borrowings (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Consumer Loans {data-navmenu="Commercial Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Commercial_Banks_SA_weekly,
  'Last Value, bln $' = last(Commercial_Banks_SA_weekly$Consumer_loans),
  'Change from Last Week' = paste0(format((last(Commercial_Banks_SA_weekly$Consumer_loans) / nth(Commercial_Banks_SA_weekly$Consumer_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Commercial_Banks_SA_weekly$Consumer_loans) / nth(Commercial_Banks_SA_weekly$Consumer_loans, n = -5) - 1)  * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Commercial_Banks_SA_weekly$Consumer_loans) / nth(Commercial_Banks_SA_weekly$Consumer_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Consumer loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_SA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_NSA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Consumer loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Real Estate Loans {data-navmenu="Commercial Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Commercial_Banks_SA_weekly,
  'Last Value, bln $' = last(Commercial_Banks_SA_weekly$Real_estate_loans),
  'Change from Last Week' = paste0(format((last(Commercial_Banks_SA_weekly$Real_estate_loans) / nth(Commercial_Banks_SA_weekly$Real_estate_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Commercial_Banks_SA_weekly$Real_estate_loans) / nth(Commercial_Banks_SA_weekly$Real_estate_loans, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Commercial_Banks_SA_weekly$Real_estate_loans) / nth(Commercial_Banks_SA_weekly$Real_estate_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Real estate loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_SA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_NSA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Real estate loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# MBS {data-navmenu="Commercial Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Commercial_Banks_SA_weekly,
  'Last Value, bln $' = last(Commercial_Banks_SA_weekly$`Mortgage-backed_securities_(MBS)`),
  'Change from Last Week' = paste0(format((last(Commercial_Banks_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Commercial_Banks_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -2) - 1 ) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Commercial_Banks_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Commercial_Banks_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -5)  - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Commercial_Banks_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Commercial_Banks_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Mortgage-backed securities (MBS) {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_SA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Commercial_Banks_NSA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Commercial_Banks_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Mortgage-backed securities (MBS) (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Commercial_Banks_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Commercial_Banks_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Bank Credit {data-navmenu="Domestic Banks"}

## Stats {.sidebar}


### Stats:

```{r}
kable(t(summarise(Domestic_SA_weekly,
  'Last Value, bln $' = last(Domestic_SA_weekly$Bank_credit),
  'Change from Last Week' = paste0(format((last(Domestic_SA_weekly$Bank_credit) / nth(Domestic_SA_weekly$Bank_credit, n = -2) - 1), digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format(last(Domestic_SA_weekly$Bank_credit) / nth(Domestic_SA_weekly$Bank_credit, n = -5) - 1, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Domestic_SA_weekly$Bank_credit) / nth(Domestic_SA_weekly$Bank_credit, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Bank Credit {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_SA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_NSA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Bank Credit (difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted 

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Borrowings {data-navmenu="Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Domestic_SA_weekly,
  'Last Value, bln $' = last(Domestic_SA_weekly$Borrowings),
  'Change from Last Week' = paste0(format((last(Domestic_SA_weekly$Borrowings) / nth(Domestic_SA_weekly$Borrowings, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Domestic_SA_weekly$Borrowings) / nth(Domestic_SA_weekly$Borrowings, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Domestic_SA_weekly$Borrowings) / nth(Domestic_SA_weekly$Borrowings, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Borrowings {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_SA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_NSA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Borrowings (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Consumer Loans {data-navmenu="Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Domestic_SA_weekly,
  'Last Value, bln $' = last(Domestic_SA_weekly$Consumer_loans),
  'Change from Last Week' = paste0(format((last(Domestic_SA_weekly$Consumer_loans) / nth(Domestic_SA_weekly$Consumer_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Domestic_SA_weekly$Consumer_loans) / nth(Domestic_SA_weekly$Consumer_loans, n = -5) - 1)  * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Domestic_SA_weekly$Consumer_loans) / nth(Domestic_SA_weekly$Consumer_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Consumer loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_SA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_NSA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Consumer loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Real Estate Loans {data-navmenu="Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Domestic_SA_weekly,
  'Last Value, bln $' = last(Domestic_SA_weekly$Real_estate_loans),
  'Change from Last Week' = paste0(format((last(Domestic_SA_weekly$Real_estate_loans) / nth(Domestic_SA_weekly$Real_estate_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Domestic_SA_weekly$Real_estate_loans) / nth(Domestic_SA_weekly$Real_estate_loans, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Domestic_SA_weekly$Real_estate_loans) / nth(Domestic_SA_weekly$Real_estate_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Real estate loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_SA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_NSA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Real estate loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# MBS {data-navmenu="Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Domestic_SA_weekly,
  'Last Value, bln $' = last(Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`),
  'Change from Last Week' = paste0(format((last(Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -2) - 1 ) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -5)  - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Mortgage-backed securities (MBS) {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_SA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Domestic_NSA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Mortgage-backed securities (MBS) (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Bank Credit {data-navmenu="Large Domestic Banks"}

## Stats {.sidebar}


### Stats:

```{r}
kable(t(summarise(Large_Domestic_SA_weekly,
  'Last Value, bln $' = last(Large_Domestic_SA_weekly$Bank_credit),
  'Change from Last Week' = paste0(format((last(Large_Domestic_SA_weekly$Bank_credit) / nth(Large_Domestic_SA_weekly$Bank_credit, n = -2) - 1), digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format(last(Large_Domestic_SA_weekly$Bank_credit) / nth(Large_Domestic_SA_weekly$Bank_credit, n = -5) - 1, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Large_Domestic_SA_weekly$Bank_credit) / nth(Large_Domestic_SA_weekly$Bank_credit, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Bank Credit {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_SA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_NSA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Bank Credit (difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted 

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Borrowings {data-navmenu="Large Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Large_Domestic_SA_weekly,
  'Last Value, bln $' = last(Large_Domestic_SA_weekly$Borrowings),
  'Change from Last Week' = paste0(format((last(Large_Domestic_SA_weekly$Borrowings) / nth(Large_Domestic_SA_weekly$Borrowings, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Large_Domestic_SA_weekly$Borrowings) / nth(Large_Domestic_SA_weekly$Borrowings, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Large_Domestic_SA_weekly$Borrowings) / nth(Large_Domestic_SA_weekly$Borrowings, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Borrowings {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_SA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_NSA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Borrowings (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Consumer Loans {data-navmenu="Large Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Large_Domestic_SA_weekly,
  'Last Value, bln $' = last(Large_Domestic_SA_weekly$Consumer_loans),
  'Change from Last Week' = paste0(format((last(Large_Domestic_SA_weekly$Consumer_loans) / nth(Large_Domestic_SA_weekly$Consumer_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Large_Domestic_SA_weekly$Consumer_loans) / nth(Large_Domestic_SA_weekly$Consumer_loans, n = -5) - 1)  * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Large_Domestic_SA_weekly$Consumer_loans) / nth(Large_Domestic_SA_weekly$Consumer_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Consumer loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_SA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_NSA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Consumer loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Real Estate Loans {data-navmenu="Large Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Large_Domestic_SA_weekly,
  'Last Value, bln $' = last(Large_Domestic_SA_weekly$Real_estate_loans),
  'Change from Last Week' = paste0(format((last(Large_Domestic_SA_weekly$Real_estate_loans) / nth(Large_Domestic_SA_weekly$Real_estate_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Large_Domestic_SA_weekly$Real_estate_loans) / nth(Large_Domestic_SA_weekly$Real_estate_loans, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Large_Domestic_SA_weekly$Real_estate_loans) / nth(Large_Domestic_SA_weekly$Real_estate_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Real estate loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_SA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_NSA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Real estate loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# MBS {data-navmenu="Large Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Large_Domestic_SA_weekly,
  'Last Value, bln $' = last(Large_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`),
  'Change from Last Week' = paste0(format((last(Large_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Large_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -2) - 1 ) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Large_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Large_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -5)  - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Large_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Large_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Mortgage-backed securities (MBS) {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_SA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Large_Domestic_NSA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Large_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Mortgage-backed securities (MBS) (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Large_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Large_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Bank Credit {data-navmenu="Small Domestic Banks"}

## Stats {.sidebar}


### Stats:

```{r}
kable(t(summarise(Small_Domestic_SA_weekly,
  'Last Value, bln $' = last(Small_Domestic_SA_weekly$Bank_credit),
  'Change from Last Week' = paste0(format((last(Small_Domestic_SA_weekly$Bank_credit) / nth(Small_Domestic_SA_weekly$Bank_credit, n = -2) - 1), digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format(last(Small_Domestic_SA_weekly$Bank_credit) / nth(Small_Domestic_SA_weekly$Bank_credit, n = -5) - 1, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Small_Domestic_SA_weekly$Bank_credit) / nth(Small_Domestic_SA_weekly$Bank_credit, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Bank Credit {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_SA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_NSA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Bank Credit (difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted 

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Borrowings {data-navmenu="Small Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Small_Domestic_SA_weekly,
  'Last Value, bln $' = last(Small_Domestic_SA_weekly$Borrowings),
  'Change from Last Week' = paste0(format((last(Small_Domestic_SA_weekly$Borrowings) / nth(Small_Domestic_SA_weekly$Borrowings, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Small_Domestic_SA_weekly$Borrowings) / nth(Small_Domestic_SA_weekly$Borrowings, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Small_Domestic_SA_weekly$Borrowings) / nth(Small_Domestic_SA_weekly$Borrowings, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Borrowings {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_SA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_NSA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Borrowings (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Consumer Loans {data-navmenu="Small Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Small_Domestic_SA_weekly,
  'Last Value, bln $' = last(Small_Domestic_SA_weekly$Consumer_loans),
  'Change from Last Week' = paste0(format((last(Small_Domestic_SA_weekly$Consumer_loans) / nth(Small_Domestic_SA_weekly$Consumer_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Small_Domestic_SA_weekly$Consumer_loans) / nth(Small_Domestic_SA_weekly$Consumer_loans, n = -5) - 1)  * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Small_Domestic_SA_weekly$Consumer_loans) / nth(Small_Domestic_SA_weekly$Consumer_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Consumer loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_SA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_NSA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Consumer loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Real Estate Loans {data-navmenu="Small Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Small_Domestic_SA_weekly,
  'Last Value, bln $' = last(Small_Domestic_SA_weekly$Real_estate_loans),
  'Change from Last Week' = paste0(format((last(Small_Domestic_SA_weekly$Real_estate_loans) / nth(Small_Domestic_SA_weekly$Real_estate_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Small_Domestic_SA_weekly$Real_estate_loans) / nth(Small_Domestic_SA_weekly$Real_estate_loans, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Small_Domestic_SA_weekly$Real_estate_loans) / nth(Small_Domestic_SA_weekly$Real_estate_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Real estate loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_SA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_NSA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Real estate loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# MBS {data-navmenu="Small Domestic Banks"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Small_Domestic_SA_weekly,
  'Last Value, bln $' = last(Small_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`),
  'Change from Last Week' = paste0(format((last(Small_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Small_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -2) - 1 ) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Small_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Small_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -5)  - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Small_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Small_Domestic_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Mortgage-backed securities (MBS) {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_SA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Small_Domestic_NSA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Small_Domestic_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Mortgage-backed securities (MBS) (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Small_Domestic_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Small_Domestic_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Bank Credit {data-navmenu="Foreign Institutions"}

## Stats {.sidebar}


### Stats:

```{r}
kable(t(summarise(Foreign_SA_weekly,
  'Last Value, bln $' = last(Foreign_SA_weekly$Bank_credit),
  'Change from Last Week' = paste0(format((last(Foreign_SA_weekly$Bank_credit) / nth(Foreign_SA_weekly$Bank_credit, n = -2) - 1), digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format(last(Foreign_SA_weekly$Bank_credit) / nth(Foreign_SA_weekly$Bank_credit, n = -5) - 1, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Foreign_SA_weekly$Bank_credit) / nth(Foreign_SA_weekly$Bank_credit, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Bank Credit {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_SA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Bank_credit)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_NSA_weekly, n = 1), aes(label = Bank_credit), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Bank Credit (difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted 

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Bank_credit)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Bank Credit (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Borrowings {data-navmenu="Foreign Institutions"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Foreign_SA_weekly,
  'Last Value, bln $' = last(Foreign_SA_weekly$Borrowings),
  'Change from Last Week' = paste0(format((last(Foreign_SA_weekly$Borrowings) / nth(Foreign_SA_weekly$Borrowings, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Foreign_SA_weekly$Borrowings) / nth(Foreign_SA_weekly$Borrowings, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Foreign_SA_weekly$Borrowings) / nth(Foreign_SA_weekly$Borrowings, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Borrowings {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_SA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Borrowings)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_NSA_weekly, n = 1), aes(label = Borrowings), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Borrowings (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Borrowings)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Borrowings (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Consumer Loans {data-navmenu="Foreign Institutions"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Foreign_SA_weekly,
  'Last Value, bln $' = last(Foreign_SA_weekly$Consumer_loans),
  'Change from Last Week' = paste0(format((last(Foreign_SA_weekly$Consumer_loans) / nth(Foreign_SA_weekly$Consumer_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Foreign_SA_weekly$Consumer_loans) / nth(Foreign_SA_weekly$Consumer_loans, n = -5) - 1)  * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Foreign_SA_weekly$Consumer_loans) / nth(Foreign_SA_weekly$Consumer_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Consumer loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_SA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Consumer_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_NSA_weekly, n = 1), aes(label = Consumer_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Consumer loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Consumer_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Consumer loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# Real Estate Loans {data-navmenu="Foreign Institutions"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Foreign_SA_weekly,
  'Last Value, bln $' = last(Foreign_SA_weekly$Real_estate_loans),
  'Change from Last Week' = paste0(format((last(Foreign_SA_weekly$Real_estate_loans) / nth(Foreign_SA_weekly$Real_estate_loans, n = -2) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Foreign_SA_weekly$Real_estate_loans) / nth(Foreign_SA_weekly$Real_estate_loans, n = -5) - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Foreign_SA_weekly$Real_estate_loans) / nth(Foreign_SA_weekly$Real_estate_loans, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Real estate loans {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_SA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = Real_estate_loans)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_NSA_weekly, n = 1), aes(label = Real_estate_loans), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Real estate loans (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(Real_estate_loans)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Real estate loans (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

# MBS {data-navmenu="Foreign Institutions"}

## Stats {.sidebar}

### Stats:

```{r}
kable(t(summarise(Foreign_SA_weekly,
  'Last Value, bln $' = last(Foreign_SA_weekly$`Mortgage-backed_securities_(MBS)`),
  'Change from Last Week' = paste0(format((last(Foreign_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Foreign_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -2) - 1 ) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 5 Weeks Ago' = paste0(format((last(Foreign_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Foreign_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -5)  - 1) * 100, digits = 2, nsmall = 2), " %"),
  'Change from 1 Year Ago' = paste0(format((last(Foreign_SA_weekly$`Mortgage-backed_securities_(MBS)`) / nth(Foreign_SA_weekly$`Mortgage-backed_securities_(MBS)`, n = -52) - 1) * 100, digits = 2, nsmall = 2), " %")
))) %>%
  kable_minimal() %>%    kable_paper("hover", full_width = F)
```

Summary for Seasonally Adjusted data.

## Mortgage-backed securities (MBS) {.col width="10/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_SA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_SA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = `Mortgage-backed_securities_(MBS)`)) +
  geom_line(size = 2) +
  geom_text(data = tail(Foreign_NSA_weekly, n = 1), aes(label = `Mortgage-backed_securities_(MBS)`), hjust = 0.75, vjust = -0.6, face = "bold", family = "mono", color = "blue") +
  geom_point(data = tail(Foreign_NSA_weekly, n = 1), size = 3, color = "blue") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (MBS)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(panel.grid.major = element_line()) +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
         plot.caption = element_text(face = "bold", family = "mono"))
```

## Mortgage-backed securities (MBS) (Difference) {.col width="5/20" .tabset .tabset-fade}

### Seasonally Adjusted

```{r}
Foreign_SA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```

### Not Seasonally Adjusted

```{r}
Foreign_NSA_weekly %>% 
  tail(n = 26) %>% 
  ggplot(aes(x = Date, y = c(0, diff(`Mortgage-backed_securities_(MBS)`)))) +
  geom_line(size = 2) +
  geom_hline(yintercept = 0, color = "red") +
  scale_x_date(date_breaks = "1 week", date_labels = "%Y-%m-%d") +
  labs(title = "Mortgage-backed securities (Difference)",
       subtitle = "in billions $") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold", family = "mono"),
        axis.title = element_blank(),
        panel.grid.major = element_line(),
        plot.subtitle = element_text(hjust = 0.5, size = 8, face = "italic", family = "mono"),
        axis.text = element_text(size = 10, family = "mono"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(face = "bold", family = "mono"))
```










